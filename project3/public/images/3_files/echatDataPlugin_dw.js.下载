!function(){function t(){var t,e,n,o,i={OLD:"ga.js",NEW:"analytics.js"},c="Zopim Livechat",a=function(){function r(t,e){return e?null==t:t===a}function v(t){return"function"==typeof t}function u(t){return"[object Array]"==Object.prototype.toString.call(t)}function d(){if(t||e)return!0;var o,i=window[window.GoogleAnalyticsObject||"ga"];return v(i)&&(e=i,o=!0),window._gaq&&window._gat&&(t=window._gaq,n=window._gat,o=!0),o}function f(t){var o;return t==i.NEW&&e&&v(e.getAll)?o=e.getAll():t==i.OLD&&n&&(v(n._getTrackers)?o=n._getTrackers():v(n._getTrackerByName)&&(o=[n._getTrackerByName()])),u(o)?o:[]}function s(t,e,n,o){try{l(t,e,n,o)}catch(i){}}function l(n,o,i,c){d()&&n&&(e&&w(n,o,i,c),t&&E(n,o,i,c))}function w(t,n,a,u){o=f(i.NEW);var d={hitType:"event",eventCategory:a||c,eventAction:t};if(r(n,!0)||(d.eventLabel=n),r(u,!0)||(d.eventValue=u),o.length)for(var n=0,s=o.length;s>n;n++)v(o[n].send)&&o[n].send("event",d);else e("send",d)}function E(e,n,a,u){o=f(i.OLD),t.push(function(){for(var t=0,i=o.length;i>t;t++)v(o[t]._trackEvent)&&(r(n,!0)&&(n=void 0),r(u,!0)&&(u=void 0),o[t]._trackEvent(a||c,e,n,u))})}return{trackEvent:s}}();return a}function e(t,e,n){if(t&&n&&"function"==typeof n){if("string"==typeof t){var o=document.getElementById(t);if(!o)return console.log("没有找到echat对话窗口"),!1;if(t=o.contentWindow||document.frames[t],!t)return console.log("没有找到echat对话窗口"),!1}var i=window,c=t;return i.addEventListener&&(i.addEventListener("message",function(t){t.origin==(e||"http://es.echatsoft.com")&&n(t.data)}),this.changeTarget=function(t){c=t},this.send=function(t){if(t&&e)try{c.postMessage(t,e)}catch(n){console.log(n)}}),this}}function n(){ECHATEventBridge({echatWin:"ECHAT_mini_win",echatHost:o})}var o=function(t){function e(t){return t.hasAttribute?t.src:t.getAttribute("src",4)}var n=document.scripts,o=t.getElementById("echatDataPlugin")||n[n.length-1],i=e(o),c=/^(http[s]?:\/\/[^\/]+)\/.+/g.exec(i);return c?c[1]:null}(document),i=!1;window.ECHATEventBridge=function(n){if(n=n||{},n.newEvent&&"undefined"!=typeof window.ECHAT&&ECHAT.on)ECHAT.on({ready:function(){ECHAT.on({newEvent:function(t){100==t.act&&n.newEvent(t)}})}});else if(n.newEvent)var o=new e(n.echatWin||"ECHAT_mini_chat",n.echatHost||"http://es.echatsoft.com",function(t){100==t.act&&n.newEvent(t)});if(!i)if(i=!0,"undefined"!=typeof window.ECHAT&&ECHAT.on)ECHAT.on({ready:function(){ECHAT.on({newEvent:function(e){200==e.act&&("Served by Agent"==e.eventAction&&(e.eventAction="Served by Operator"),t().trackEvent(e.eventAction,e.eventLabel,void 0,e.eventValue))}})}});else{var o=new e(n.echatWin||"ECHAT_mini_chat",n.echatHost||"http://es.echatsoft.com",function(e){200==e.act&&("Served by Agent"==e.eventAction&&(e.eventAction="Served by Operator"),t().trackEvent(e.eventAction,e.eventLabel,void 0,e.eventValue))});o===!1&&(i=!1)}return n.echatWin&&n.echatHost?{sendGa:function(e){t().trackEvent(e.eventAction,e.eventLabel,void 0,e.eventValue)}}:!1},window.addEventListener?window.addEventListener("load",n):window.attachEvent&&window.attachEvent("onload",n)}();